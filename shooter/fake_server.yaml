messages:
    - register: !CaptureRegister &register
        destination: "{id}"
        message:
            temporary_robot_id: "{temp_id}"
            video_url: "{url}"
            image: "{image}"
    - registered: !CaptureRegistered &registered
        destination: "{id}"
        message:
            robot_id: "looser_robot"
            team: "Loosers"
    - game_state_start: !CaptureGameState &game_state_start
        destination: "{id}"
        message:
            playing: 1
            seconds: 42
            teams:
                - name: "Loosers"
                  score: 0
                  num_players: 1
                  players:
                      - "looser_robot"
    - game_state_stop: !CaptureGameState &game_state_stop
        destination: "{id}"
        message:
            playing: 0
            seconds: 0
            teams:
                - name: "Loosers"
                  score: 0
                  num_players: 1
                  players:
                      - "looser_robot"
            winner: ""

sockets:
    - !SocketSubscribe &subscribe
        port: 9000
        bind: no
    - !SocketPush &push
        port: 9001
        bind: no

threads:
    - !Thread
        name: "fake server"
        loop: False
        in_socket: *subscribe
        out_socket: *push
        flow:
            - !In
                message: *register
            - !Out
                message: *registered
                arguments:
                    id: "{Register[0].temp_id}"
            - !Out
                message: *game_state_start
                arguments:
                    id: "looser_robot"
            - !Out
                message: *game_state_stop
                arguments:
                    id: "looser_robot"

